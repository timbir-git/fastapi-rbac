import"./default.76e08716.js";import{M as F}from"./index.647ff16d.js";import"./index.47c5c8b2.js";import{I as T,_ as S,F as U}from"./index.6e8bd907.js";import"./index.fa696f9c.js";import"./index.5fedb982.js";import{_ as D}from"./index.4ab42408.js";import{_ as N,a as O,r as c,J as q,o as j,b as B,e as l,w as d,f as k,a$ as E,bi as P,u as $,bE as z}from"./index.851d8163.js";import{a as J,p as V}from"./role.88369262.js";import{g as A}from"./menu.967b72d4.js";import{u as G}from"./useModal.960570e2.js";const de=[{title:"ID",dataIndex:"id",key:"id"},{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u63CF\u8FF0",dataIndex:"remark",key:"remark"},{title:"\u72B6\u6001",dataIndex:"status",key:"status"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created",key:"created"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"modified",key:"modified"},{title:"\u64CD\u4F5C",key:"action"}],H={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},{min:3,max:12,message:"3-12",trigger:"blur"}],remark:[{required:!0,message:"\u8BF7\u8F93\u5165\u63CF\u8FF0",trigger:"blur"},{min:1,max:20,message:"1~20",trigger:"blur"}],menus:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355",trigger:"blur"}]},L={key:"id",title:"name",children:"children"},Q={class:"modal"},W={__name:"role-modal",props:{modalTitle:{type:String},modalType:{type:String,default:"create"}},setup(v,{expose:x}){const h=v,{showModal:s,updateId:y,formRef:p}=G(),t=O({name:"",remark:"",menus:[]}),g=c(),M=c();q(s,async a=>{if(a){const e=await A();g.value=e.data}});const u=c([]),f=c([]),I=(a,e)=>{t.menus=[...e.halfCheckedKeys,...a]},K=a=>{let e=[],o=[];return z(a.id).then(m=>{function i(_){for(const r of _)e.push(r.id),r.children?i(r.children):o.push(r.id)}i(m.data)}),{allMenus:e,checkMenus:o}},R=a=>{s.value=!0;const{allMenus:e,checkMenus:o}=K(a);y.value=a.id,t.name=a.name,t.remark=a.remark,u.value=o,t.menus=e},b=()=>{p.value.resetFields(),u.value=[],f.value=[]},w=()=>{p.value.validateFields().then(async()=>{let a;h.modalType==="create"?a=await J(t):a=await V(y.value,t),P(a),b(),s.value=!s.value,$().isPush=!0})},C=()=>{b()};return x({showModal:s,openModal:R}),(a,e)=>{const o=T,m=S,i=D,_=U,r=F;return j(),B("div",Q,[l(r,{visible:k(s),"onUpdate:visible":e[4]||(e[4]=n=>E(s)?s.value=n:null),title:v.modalTitle,"ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onOk:w,onCancel:C},{default:d(()=>[l(_,{ref_key:"formRef",ref:p,model:t,rules:k(H)},{default:d(()=>[l(m,{name:"name",label:"\u540D\u79F0"},{default:d(()=>[l(o,{value:t.name,"onUpdate:value":e[0]||(e[0]=n=>t.name=n)},null,8,["value"])]),_:1}),l(m,{name:"remark",label:"\u63CF\u8FF0"},{default:d(()=>[l(o,{value:t.remark,"onUpdate:value":e[1]||(e[1]=n=>t.remark=n)},null,8,["value"])]),_:1}),l(m,{name:"menus",label:"\u83DC\u5355"},{default:d(()=>[l(i,{ref_key:"treeRef",ref:M,checkable:"","tree-data":g.value,fieldNames:k(L),onCheck:I,checkedKeys:u.value,"onUpdate:checkedKeys":e[2]||(e[2]=n=>u.value=n),expandedKeys:f.value,"onUpdate:expandedKeys":e[3]||(e[3]=n=>f.value=n)},null,8,["tree-data","fieldNames","checkedKeys","expandedKeys"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"])])}}},X=N(W,[["__file","D:/Code/fastapi_rbac/frontend/src/views/main/system/role/role-modal.vue"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as R,de as c,ue as r};
